[
    "# Rule 100: For action 'take', if the agent's hand is already holding an item, the action will fail; Checking Method: Check if 'item_in_hand' in 'initial_state' has a non-null 'item_name'. \ndef Rule_100_take(state, action, scene_graph):\n    # Extract the action name\n    action_name = action.get(\"name\")\n    \n    # Check if the action is 'take'\n    if action_name == \"take\":\n        # Check if the agent's hand is already holding an item\n        item_in_hand = state.get(\"item_in_hand\", {}).get(\"item_name\")\n        if item_in_hand:\n            feedback = \"Action failed: The agent is already holding an item.\"\n            success = False\n            suggestion = \"Put down the current item before taking another one.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'take', consider it successful by default\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 101: For action 'take', if the item is not present in the specified location, the action will fail; Checking Method: Check if the 'obj' in 'action' is not listed under 'items_in_locations' for the 'source' location in 'initial_state'. \ndef Rule_101_take(state, action, scene_graph):\n    # Extract action details\n    action_name = action.get(\"name\")\n    action_args = action.get(\"args\", {})\n    \n    # Check if the action is 'take'\n    if action_name == \"take\":\n        obj = action_args.get(\"obj\")\n        source = action_args.get(\"source\")\n        \n        # Check if the object is present in the specified source location\n        items_in_source = state.get(\"items_in_locations\", {}).get(source, [])\n        \n        if obj not in items_in_source:\n            feedback = f\"Action failed: {obj} is not present in {source}.\"\n            success = False\n            suggestion = f\"Check the items in {source} and try taking an available item.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'take', consider it successful\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 102: For action 'take', if the agent is not at the specified location, the action will fail; Checking Method: Check if 'current_position' in 'initial_state' does not match the 'source' location in 'action'. \ndef Rule_102_take(state, action, scene_graph):\n    if action['name'] == 'take':\n        current_location = state['current_position']['location_name']\n        source_location = action['args']['source']\n        \n        if current_location != source_location:\n            feedback = \"Action failed: You are not at the specified location to take the item.\"\n            success = False\n            suggestion = f\"Move to {source_location} before attempting to take the item.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'take', consider it successful by default\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 103: For action 'open', if the target location is not in the list of reachable locations, the action will fail; Checking Method: Check if 'action.args.target' is not in 'reachable_locations'. \ndef Rule_103_open(state, action, scene_graph):\n    if action['name'] == 'open':\n        target = action['args']['target']\n        if target not in state['reachable_locations']:\n            feedback = f\"Action failed: The target location '{target}' is not reachable.\"\n            success = False\n            suggestion = f\"Try moving closer to '{target}' before attempting to open it.\"\n            return feedback, success, suggestion\n    # If the action is not 'open', consider it successful by default\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 104: For action 'open', if the target location is a fridge and the current position is not the same as the target location, the action will fail; Checking Method: Check if 'action.args.target' is 'fridge' and 'current_position.location_name' is not equal to 'action.args.target'. \ndef Rule_104_open(state, action, scene_graph):\n    # Extract necessary information from state and action\n    current_position = state[\"current_position\"][\"location_name\"]\n    action_name = action[\"name\"]\n    target = action[\"args\"].get(\"target\", \"\")\n\n    # Check if the action is 'open' and the target is a fridge\n    if action_name == \"open\" and \"fridge\" in target:\n        # Check if the current position is not the same as the target location\n        if current_position != target:\n            feedback = \"Action failed: You must be at the fridge to open it.\"\n            success = False\n            suggestion = f\"Move to {target} before trying to open it.\"\n            return feedback, success, suggestion\n\n    # If the action is not 'open' or the rule does not apply, consider it successful\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 105: For action 'open', if the target location is a drawer and the current position is not the same as the target location, the action will fail; Checking Method: Check if 'action.args.target' starts with 'drawer' and 'current_position.location_name' is not equal to 'action.args.target'. \ndef Rule_105_open(state, action, scene_graph):\n    # Extract necessary information from state and action\n    current_position = state[\"current_position\"][\"location_name\"]\n    action_name = action[\"name\"]\n    target_location = action[\"args\"].get(\"target\", \"\")\n\n    # Check if the action is 'open' and the target is a drawer\n    if action_name == \"open\" and target_location.startswith(\"drawer\"):\n        # Check if the current position is not the same as the target location\n        if current_position != target_location:\n            feedback = \"Action failed: You must be at the drawer to open it.\"\n            success = False\n            suggestion = f\"Move to {target_location} before trying to open it.\"\n            return feedback, success, suggestion\n\n    # If the action is not 'open' or the rule does not apply, consider it successful\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 106: For action 'heat', if the object to be heated is not in the tool, the action will fail; Checking Method: Check if the 'item_in_hand' matches the object to be heated and is not placed in the tool location. \ndef Rule_106_heat(state, action, scene_graph):\n    # Extract necessary information from the state and action\n    action_name = action.get(\"name\")\n    action_args = action.get(\"args\", {})\n    obj_to_heat = action_args.get(\"obj\")\n    tool = action_args.get(\"tool\")\n    \n    # Check if the action is 'heat'\n    if action_name == \"heat\":\n        # Check if the object to be heated is in hand and not in the tool location\n        item_in_hand = state.get(\"item_in_hand\", {}).get(\"item_name\")\n        current_position = state.get(\"current_position\", {}).get(\"location_name\")\n        \n        if item_in_hand == obj_to_heat and current_position != tool:\n            feedback = f\"Failed to heat {obj_to_heat}. It must be placed in {tool} to be heated.\"\n            success = False\n            suggestion = f\"Place {obj_to_heat} in {tool} before heating.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'heat', consider it successful\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 107: For action 'put', if the item to be put is not in hand, the action will fail; Checking Method: Check if 'item_name' in 'item_in_hand' of the 'initial_state' matches the 'obj' in action args. \ndef Rule_107_put(state, action, scene_graph):\n    if action['name'] == 'put':\n        obj_to_put = action['args']['obj']\n        item_in_hand = state['item_in_hand']['item_name']\n        \n        if obj_to_put != item_in_hand:\n            feedback = f\"Action failed: {obj_to_put} is not in hand.\"\n            success = False\n            suggestion = f\"Ensure you have {obj_to_put} in hand before attempting to put it.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'put', consider it successful by default\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 108: For action 'put', if the current position is not the same as the target location, the action will fail; Checking Method: Check if 'location_name' in 'current_position' of the 'initial_state' matches the 'target' in action args. \ndef Rule_108_put(state, action, scene_graph):\n    if action['name'] == 'put':\n        current_location = state['current_position']['location_name']\n        target_location = action['args']['target']\n        \n        if current_location != target_location:\n            feedback = \"Action failed: You must be at the target location to put the item.\"\n            success = False\n            suggestion = f\"Move to {target_location} before attempting to put the item.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'put', consider it successful by default\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 109: For action 'use', if the object is not in the current location, the action will fail; Checking Method: Check if the object specified in the action is not present in the 'items_in_locations' of the 'current_position' in the initial state. \ndef Rule_109_use(state, action, scene_graph):\n    if action['name'] == 'use':\n        obj = action['args']['obj']\n        current_location = state['current_position']['location_name']\n        \n        # Check if the object is in the current location\n        if obj not in state['items_in_locations'].get(current_location, []):\n            feedback = f\"Action failed: {obj} is not in the current location {current_location}.\"\n            success = False\n            suggestion = f\"Move to the location where {obj} is present or bring {obj} to the current location.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'use', consider it successful\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 110: For action clean, if the object to be cleaned is not in hand, the action will fail; Checking Method: Check if the 'item_in_hand' matches the object specified in the action. \ndef Rule_110_clean(state, action, scene_graph):\n    # Extract the action name and arguments\n    action_name = action.get(\"name\")\n    action_args = action.get(\"args\", {})\n    \n    # Check if the action is 'clean'\n    if action_name == \"clean\":\n        # Get the object to be cleaned from the action arguments\n        obj_to_clean = action_args.get(\"obj\")\n        \n        # Get the item currently in hand\n        item_in_hand = state.get(\"item_in_hand\", {}).get(\"item_name\")\n        \n        # Check if the object to be cleaned is in hand\n        if obj_to_clean != item_in_hand:\n            feedback = f\"Action failed: {obj_to_clean} is not in hand.\"\n            success = False\n            suggestion = f\"Please ensure {obj_to_clean} is in hand before cleaning.\"\n            return feedback, success, suggestion\n    \n    # If the action is not 'clean', consider it successful\n    feedback = \"Action executed successfully.\"\n    success = True\n    suggestion = \"\"\n    return feedback, success, suggestion\n",
    "# Rule 111: For action take, if the source location does not contain the object, the action will fail; Checking Method: Check if 'obj' is not in 'items_in_locations[source]'. \ndef Rule_111_take(state, action, scene_graph):\n    if action['name'] == 'take':\n        obj = action['args']['obj']\n        source = action['args']['source']\n        \n        if obj in state['items_in_locations'].get(source, []):\n            feedback = f\"Successfully took the {obj} from {source}.\"\n            success = True\n        else:\n            feedback = f\"Failed to take the {obj} from {source} because it is not there.\"\n            success = False\n            suggestion = f\"Please check if the {obj} is in another location or try to explore the {source}.\"\n            return feedback, success, suggestion\n        \n    # If the action type is not 'take', count as success\n    feedback = f\"The action '{action['name']}' was executed.\"\n    success = True\n    suggestion = \"\"\n    \n    return feedback, success, suggestion\n",
    "# Rule 112: For action take, if the source location is not reachable, the action will fail; Checking Method: Check if 'source' is not in 'reachable_locations'. \ndef Rule_112_take(state, action, scene_graph):\n    if action['name'] == 'take':\n        source = action['args']['source']\n        \n        if source not in state['reachable_locations']:\n            feedback = f\"Failed to take the item from {source} as it is not reachable.\"\n            success = False\n            suggestion = f\"Please go to a reachable location to take the item.\"\n        else:\n            feedback = \"Successfully took the item.\"\n            success = True\n            suggestion = \"\"\n    else:\n        feedback = \"Action type is not 'take', counting as success.\"\n        success = True\n        suggestion = \"\"\n    \n    return feedback, success, suggestion\n",
    "# Rule 113: For action take, if the source location is not reachable, the action will fail; Checking Method: Check if 'source' is in 'reachable_locations'. \ndef Rule_113_take(state, action, scene_graph):\n    if action[\"name\"] == \"take\":\n        source = action[\"args\"][\"source\"]\n        \n        if source not in state[\"reachable_locations\"]:\n            feedback = f\"Failed to take the item from {source} as it is not reachable.\"\n            success = False\n            suggestion = f\"Please move to a reachable location to take the item.\"\n        else:\n            feedback = f\"Successfully took the item from {source}.\"\n            success = True\n            suggestion = \"\"\n    else:\n        feedback = f\"Action type '{action['name']}' is not relevant to the rule.\"\n        success = True  # Success is True for non-relevant actions\n        suggestion = \"\"\n    \n    return feedback, success, suggestion\n",
    "# Rule 114: For action take, if the source location is closed, the action will fail; Checking Method: Check if 'current_position[status]' is 'open' for the source location. \ndef Rule_114_take(state, action, scene_graph):\n    if action['name'] == 'take':\n        source = action['args']['source']\n        current_position = state['current_position']['location_name']\n        \n        # Check if the source location is closed\n        if source == current_position and state['current_position']['status'] == 'closed':\n            feedback = \"The action failed because the source location is closed.\"\n            success = False\n            suggestion = f\"Please open the {source} before trying to take the item.\"\n        else:\n            feedback = \"The action was successful.\"\n            success = True\n            suggestion = \"\"\n    else:\n        feedback = \"The action type is not 'take', so it is considered successful.\"\n        success = True\n        suggestion = \"\"\n    \n    return feedback, success, suggestion\n"
]